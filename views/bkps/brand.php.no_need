<?php
$brand_sef_url = "";
if($brand_id>0) {
	//If page have assigned brand
	$brand_single_data_resp = get_brand_single_data_by_id($brand_id);
	$brand_single_data = $brand_single_data_resp['brand_single_data'];
	$brand_id = $brand_single_data['id'];
	$brand_sef_url = $brand_single_data['sef_url'];
	$description = $active_page_data['content'];
} else {
	//If come from home page
	$brand_single_data = $brand_single_data_resp['brand_single_data'];
	$brand_id = $brand_single_data['id'];
	$brand_sef_url = $brand_single_data['sef_url'];
	
	$meta_title = $brand_single_data['meta_title'];
	$meta_desc = $brand_single_data['meta_desc'];
	$meta_keywords = $brand_single_data['meta_keywords'];
	$meta_canonical_url = $brand_single_data['meta_canonical_url'];
	
	$description = $brand_single_data['description'];
}

//Header section
include("include/header.php");

//Fetching data from model
require_once('models/models.php');

//Get model data list from models/models.php, function get_brand_model_series_data_list
$model_series_data_list = get_brand_model_series_data_list($brand_id);
if(count($model_series_data_list)>1 && $brand_id>0) { ?>
	<section id="showCategory" class="pb-0">
		<div class="container">
		  <div class="row">
			<div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
			  <div class="block heading text-center">
				<h3><?=_lang('heading_text','device_list')?></h3>
			  </div>
			  <div class="block devices clearfix">
				<div class="row category center_content pb-5">
					<?php
					foreach($model_series_data_list as $model_series_data) { ?>
					  <div class="col-6 col-md-6 col-lg-3">
						<a href="<?=SITE_URL.$brand_sef_url.'/'.$model_series_data['sef_url']?>" class="card">
						  <div class="image">
							<?php
							if($model_series_data['device_img']) {
								$md_img_path = SITE_URL.'media/images/model_series/'.$model_series_data['device_img'];
								echo '<img src="'.$md_img_path.'" alt="'.$model_series_data['title'].'">';
								echo '<img src="'.$md_img_path.'" alt="'.$model_series_data['title'].'">';
							} ?>
						  </div>
						  <h5><?=$model_series_data['title']?></h5>
						</a>
					  </div>
					<?php
					}

					//Get model data list from models/models.php, function get_c_b_d_model_data_list
					$c_b_d_extra_param_arr['model_type_source'] = '';
					$model_series_id = 'other';
					$model_data_list = get_c_b_d_model_data_list($brand_id, $category_id, $model_series_id, $model_series_id, $c_b_d_extra_param_arr);
					if(!empty($model_data_list)) { ?>
					<div class="col-6 col-md-6 col-lg-3 other_series">
						<a href="<?=SITE_URL.$brand_sef_url.'/other'?>" class="card">
							<h5>Other</h5>
						</a>
					</div>
					<?php
					} ?>
				</div>
			  </div>
			</div>
		  </div>
		</div>
	</section>

	<?php
	if($description) { ?>
		<section class="sectionbox">
			<div class="container">
				<?=$description?>
			</div>
		</section>
	<?php
	}
} else {
	//Get model data list from models/models.php, function get_model_data_list
	$model_data_list = get_model_data_list($brand_id); ?>

	  <section id="showCategory" class="pb-0">
		<div class="container-fluid">
		  <div class="row">
			<div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
			  <div class="block heading text-center">
			    <?php
				if(isset($_SERVER['HTTP_REFERER']) && $_SERVER['HTTP_REFERER']) { ?>
			    <a class="btn btn-primary  back-button" href="javascript:void(0);" onclick="history.back();"><?=_lang('back_button_text')?></a>
				<?php
				} ?>
				<h3><?=_lang('heading_text','model_list')?></h3>
				<form action="<?=SITE_URL?>search" method="post">
				  <div class="form-group">
					<input type="text" name="search" class="form-control center mx-auto srch_list_of_model" id="autocomplete" placeholder="<?=_lang('searchbox_placeholder_text')?>">
				  </div>
				</form>
			  </div>
			  <div class="block devices inner_page_step mb-0 pb-0 clearfix">
				<div class="row justify-content-center category model-category">
				<?php
				foreach($model_data_list as $model_list) {
				  $cat_ids_array[] = $model_list['cat_id'];

				  $model_upto_price = 0;
				  $model_upto_price_data = get_model_upto_price($model_list['id'],$model_list['price']);
				  $model_upto_price = $model_upto_price_data['price']; ?>
				  <div class="col-6 col-md-4 col-lg-4 col-sm-4 col-xl-3 p-2">
					<a href="<?=SITE_URL.$model_details_page_slug.$model_list['sef_url']?>" class="card">
					  <div class="image">
					  	<?php
						if($model_list['model_img']) {
							$md_img_path = SITE_URL.'media/images/model/'.$model_list['model_img'];
							echo '<img src="'.$md_img_path.'" alt="'.$model_list['title'].'">';
						} ?>
					  </div>
					  <h5><?=$model_list['title']?></h5>
					  <?php
					  if($model_upto_price>0) {
					  	echo '<h6 class="price">Up to '.amount_fomat($model_upto_price).'</h6>';
					  } ?>
					</a>
				  </div>
				<?php
				}

				if($settings['missing_product_section']=='1') { ?>
				  <div class="col-6 col-md-4 col-lg-4 col-sm-4 col-xl-3 p-2">
					<a href="javascript:void(0);" data-toggle="modal" data-target="#MissingProduct" class="card">
					  <div class="image">
						<?php
						$md_img_path = SITE_URL.'media/images/iphone.png';
						echo '<img src="'.$md_img_path.'" alt="'._lang('missing_product_title','model_list').'">'; ?>
					  </div>
					  <h5><?=_lang('missing_product_title','model_list')?></h5>
					  <h6 class="price">&nbsp;</h6>
					</a>
				  </div>
				<?php
				} ?>
				</div>
			  </div>
			</div>
		  </div>
		</div>
	  </section>

	  <section id="haveQuestion">
		<div class="container-fluid">
		  <div class="col-md-12">
			<div class="block heading thin-title text-center clearfix">
			  <h3 class="py-4"><?=_lang('contact_us_block_title','model_list')?></h3>
			  <a href="javascript:void(0);" data-toggle="modal" data-target="#contactusForm" class="btn btn-primary btn-lg my-2"><?=_lang('contact_us_button_text','model_list')?></a>
			</div>
		  </div>
		</div>
	  </section>

		<?php
        //for sections
        $is_review_sec_show = $review_sec_show_in_model_list;
        $is_why_choose_us_sec_show = $why_choose_us_sec_show_in_model_list;
        $is_how_it_works_sec_show = $how_it_works_sec_show_in_model_list;
        require_once('views/sections/sections.php');

		if($description) { ?>
			<section class="sectionbox white-bg">
				<div class="container">
					<?=$description?>
				</div>
			</section>
		<?php
		}
		
		if(!empty($cat_ids_array)) {
			$faqs_groups_data_html = get_faqs_groups_with_html(array(),array_unique($cat_ids_array),'model_list');
			if($faqs_groups_data_html['html']!="") { ?>
				<section class="faq_page">
					<div class="container">
						<div class="block setting-page clearfix">
							<div class="wrap">
								<?=$faqs_groups_data_html['html']?>
							</div>
						</div>
					</div>		
				</section>
			<?php	
			}
		}
}

//for missing product section popup
require_once('views/sections/missing_product_section_popup.php'); 
?>
